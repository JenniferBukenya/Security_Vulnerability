<?php

//echo('hello');

// Require the database connection file
require_once 'db_connect.php';

//lets now login a user.

session_start();

// Check if the form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Check if username and password are set
    if (isset($_POST["username"]) && isset($_POST["password"])) {
        // Retrieve username and password from the form
        $username = $_POST["username"];
        $password = $_POST["password"];

        // Construct the SQL query (vulnerable to SQL injection)
        $sql = "SELECT id, username, password FROM users WHERE username = '$username'";

        // Execute the SQL query
        $result = $pdo->query($sql);

        // Check if a user with the provided username exists
        if ($result && $result->rowCount() > 0) {
            // Fetch the user record
            $user = $result->fetch(PDO::FETCH_ASSOC);

            // Verify the password
            if ($password == $user['password']) {
                // Password is correct, set session variables and redirect
                $_SESSION["user_id"] = $user["id"];
                $_SESSION["username"] = $user["username"];
                // Redirect to the dashboard or any other page
                header("Location: register.html");
                exit();
            } else {
                // Password is incorrect
                $error = "Incorrect password. Please try again.";
                echo($error);
            }
        } else {
            // User not found
            $error = "User with this username does not exist.";
            echo($error);
        }
    }
}












?>