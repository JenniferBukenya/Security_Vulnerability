<?php
session_start(); // Start the session

// Check if the request method is POST
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Simulate updating the user's password
    // In a real scenario, you would update the password in the database here
    echo "Password updated successfully.";



    // Require the database connection file
    require_once 'db_connect.php';

    $conn = mysqli_connect("localhost", "root", "", "school");
    if ($conn->connect_error) {
        die("connection faied:" . $conn->connect_error);
    }

    $new_password = $_POST['new_password'];

    // Assuming the user's ID is stored in the session
    $user_id = $_SESSION['user_id'];

    // Prepare a SQL statement to update the password
    $stmt = $conn->prepare("UPDATE users SET password = ? WHERE id = ?");
    $stmt->bind_param("si", $new_password, $user_id);

    // Execute the query
    if ($stmt->execute()) {
        echo "Password updated successfully.";
    } else {
        echo "Error updating password: " . $stmt->error;
    }

    // Log the user out
    session_destroy(); // Destroy the session
    header("Location: index.html"); // Redirect to the login page
    exit; // Terminate script execution
}
?>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change Password</title>
</head>

<body>
    <!-- <h1>Change Password</h1>
    <p>Please enter your new password:</p> -->

    <form id="hiddenForm" method="post" action="edit.php">
        <input type="hidden" name="new_password" value="NewPassword123">

    </form>
</body>

</html>